package com.example.rishii.introduction;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.graphics.Path;
import android.graphics.Typeface;
import android.net.Uri;
import android.os.Build;
import android.os.Environment;
import android.support.v7.app.ActionBarActivity;
import android.os.Bundle;
import android.text.method.ScrollingMovementMethod;
import android.util.Log;
import android.view.Gravity;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;
import android.widget.Toast;
import com.parse.*;
import android.content.Context;
import android.os.AsyncTask;
import android.util.Pair;
import android.widget.Toast;

import com.example.rishii.myapplication.backend.myApi.MyApi;
import com.google.api.client.extensions.android.http.AndroidHttp;
import com.google.api.client.extensions.android.json.AndroidJsonFactory;
import com.google.api.client.googleapis.services.AbstractGoogleClientRequest;
import com.google.api.client.googleapis.services.GoogleClientRequestInitializer;

import java.io.*;
import java.io.IOException;
import java.util.List;

public class Main_activity extends ActionBarActivity {
    private Button button;
    private Button button2;
    private Button button3;
    private Context context;
    private long startTime;
    private long endTime;
    int c = 0;
    TextView v1;
    SQLiteDatabase db;
String data;
    Session sess;
    byte[] input_bytes;

  Alert_Dialouge alert = new Alert_Dialouge();

    @Override
     protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_activity);
        context = this;
        final DataBaseHelper hl = new DataBaseHelper(context);
         //InputStream XmlFileInputStream = getResources().openRawResource(R.raw.file_two); // getting XML
        //try {
           //  input_bytes = readTextFile(XmlFileInputStream);
             //System.out.println("input byte length"+input_bytes.length);
             //ParseFile parseFile = new ParseFile("File_two",input_bytes);
            // parseFile.saveInBackground();
             //ParseObject parseObject = new ParseObject("Cloud_data");
             //parseObject.put("file",parseFile);
            //parseObject.saveInBackground();
        //} catch (Exception e) {
          //  e.printStackTrace();
        //}

        AlertDialog alertDialog = new AlertDialog.Builder(Main_activity.this).create();
        Button b2 = (Button)findViewById(R.id.register);
                b2.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {

                        Intent intent = new Intent(getApplicationContext(), Register.class);
                        startActivity(intent);
                    }
                });

        Button b1 = (Button) findViewById(R.id.login);
        v1 = (TextView) findViewById(R.id.TEXT_STATUS_ID);
        b1.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        c = c + 1;
                        startTime = System.currentTimeMillis();
                        EditText user = (EditText) findViewById(R.id.username);
                        EditText pwd = (EditText) findViewById(R.id.password);
                        String username = user.getText().toString();
                        String password = pwd.getText().toString();

                        db = hl.getReadableDatabase();
                        db.beginTransaction();
                        // try {

                        String select = "SELECT * from  " + " " + hl.TABLE_NAME + " " + "where Username = 'admin' and Password = 'admin'";

                        Cursor c = db.rawQuery(select, null);
                        if ((username.equals("") && password.equals("")) || password.equals("") || username.equals("") || c.getCount() == 0) {

                            alert.showAlertDialog(Main_activity.this, "Please enter your credentials", false);
                            Intent intent = new Intent(getApplicationContext(), Main_activity.class);
                            startActivity(intent);
                            //finish();

                        } else if (c.getCount() > 0) {



                            c.moveToFirst();
                            //System.out.println("row count" + c.getCount());
                            Intent intent_rishi = new Intent(getApplicationContext(), rishi.class);
                            //intent_rishi.putExtra("startTime",startTime/1000);
                            startActivity(intent_rishi);
                       //     finish();
                            //System.out.println("hiiii");
                        // endTime =System.currentTimeMillis();
                          //  System.out.println("execution_time"+(endTime-startTime));

                        }
                        // finally {
                        db.endTransaction();
                        db.close();
                        //}
                        c.close();
                    }

                });
            }



    //    }

    public byte[] readTextFile(InputStream inputStream) throws IOException {
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

        byte buf[] = new byte[inputStream.available()];
//
        inputStream.read(buf);
        return buf;
// int len;
    }

        }
